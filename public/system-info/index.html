<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta content="IE=edge" http-equiv="X-UA-Compatible">
	<meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport">
	<title>Stanfor2 - System Information</title><!-- Font Icons -->
	<link href="/configuration-interface/css/fonts/icomoon/icomoon.css" media="all" rel="stylesheet">
	<link href="/configuration-interface/css/fonts/roxine-font-icon/roxine-font.css" media="all" rel="stylesheet">
	<link href="/configuration-interface/vendors/font-awesome/css/font-awesome.css" media="all" rel="stylesheet"><!-- Vendors -->
	<link href="/configuration-interface/vendors/owl-carousel/dist/assets/owl.carousel.min.css" media="all" rel="stylesheet">
	<link href="/configuration-interface/vendors/owl-carousel/dist/assets/owl.theme.default.min.css" media="all" rel="stylesheet">
	<link href="/configuration-interface/vendors/animate/animate.css" media="all" rel="stylesheet">
	<link href="/configuration-interface/vendors/rateyo/jquery.rateyo.css" media="all" rel="stylesheet">
	<link href="/configuration-interface/vendors/bootstrap-datepicker/css/bootstrap-datepicker.css" media="all" rel="stylesheet">
	<link href="/configuration-interface/vendors/fancyBox/source/jquery.fancybox.css" media="all" rel="stylesheet">
	<link href="/configuration-interface/vendors/fancyBox/source/helpers/jquery.fancybox-thumbs.css" media="all" rel="stylesheet"><!-- Bootstrap 4 -->
	<link href="/configuration-interface/css/bootstrap.css" media="all" rel="stylesheet"><!-- Rev Slider -->
	<link href="/configuration-interface/vendors/rev-slider/revolution/css/settings.css" rel="stylesheet" type="text/css">
	<link href="/configuration-interface/vendors/rev-slider/revolution/css/layers.css" rel="stylesheet" type="text/css">
	<link href="/configuration-interface/vendors/rev-slider/revolution/css/navigation.css" rel="stylesheet" type="text/css"><!-- Theme CSS -->
	<link href="/configuration-interface/css/main.css" media="all" rel="stylesheet">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js">
	</script><!-- Load Moment.js from CDN -->

	<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js">
	</script><!-- Load Chart.js from CDN -->

	<script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js">
	</script><!-- Load chartjs-plugin-streaming from CDNJS -->

	<script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-streaming/2.0.0/chartjs-plugin-streaming.min.js">
	</script><!-- Load chartjs-plugin-datalabels from CDNJS -->

	<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0/dist/chartjs-plugin-datalabels.min.js">
	</script><!-- Load Chart.js Moment Adapter from CDN -->

	<script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-adapter-moment/1.0.0/chartjs-adapter-moment.min.js">
	</script>
</head>
<body>
	<!-- main wrapper -->
	<div id="wrapper">
		<div class="page-wrapper">
			<!-- header of the page -->
			<header class="fixed-top main-header header-white transparent" id="waituk-main-header">
				<div id="nav-section">
					<div class="bottom-header container-fluid mega-menus" id="mega-menus">
						<nav class="navbar navbar-toggleable-md no-border-radius no-margin mega-menu-multiple" id="navbar-inner-container">
							<form action="mega-menu-5.html" class="no-margin top-search" id="top-search" name="top-search">
								<div class="form-group no-margin">
									<input class="form-control no-border" id="search_term" name="search_term" placeholder="Type & Press Enter" type="text">
								</div>
							</form><button class="navbar-toggler navbar-toggler-left" data-target="#mega-menu" data-toggle="collapse" type="button"><span class="navbar-toggler-icon"></span></button> <!-- <a class="navbar-brand mr-auto m-sm-auto" href="index.html"> <img src="img/logo.svg" alt="roxine"> <img src="img/logo-dark.svg" alt="roxine"> </a> -->
							<div class="collapse navbar-collapse flex-row-reverse" id="mega-menu">
								<ul class="nav navbar-nav">
									<li>
										<a href="//stanfor2:8080">Home</a>
									</li>
									<li>
										<a href="/viewer-settings">Viewer Settings</a>
									</li>
									<li>
										<a href="/cbus-settings">Cbus Settings</a>
									</li>
									<li>
										<a href="/system-info">System Infomation</a>
									</li>
									<li>
										<a href="">Logout</a>
									</li>
								</ul>
							</div>
						</nav>
					</div>
				</div>
			</header><!--/header of the page -->
			<main>
				<!-- visual/banner of the page -->
				<section class="visual">
					<div class="visual-inner visual-banner-v22 dark-overlay parallax" data-stellar-background-ratio="0.55">
						<div class="container">
							<div class="visual-text-large text-left visual-center">
								<h1 class="visual-title visual-sub-title">System Information</h1>
								<p>View information about the system and status of API's &amp; Web Servers.</p>
								<div class="breadcrumb-block">
									<ol class="breadcrumb">
										<li class="breadcrumb-item">
											<a href="//stanfor2:8080/">Home</a>
										</li>
										<li class="breadcrumb-item">
											<a href="">System Information</a>
										</li>
									</ol>
								</div>
							</div>
						</div>
					</div>
				</section><!--/visual/banner of the page -->
				<!-- main content wrapper -->
				<!-- main content wrapper -->
				<div class="content-wrapper" style="min-height: 60rem;">
					<section class="content-block">
						<div class="container">
							<div class="demo-wrapper pb-0">
								<div class="bottom-space">
									<h2 class="block-main-heading text-center"><span id="hostname">Loading...</span></h2><span class="block-sub-heading text-center" id="systemModel"></span>
								</div>
								<div class="block-sub-heading text-center bottom-space" id="systemInfo">
									<p><b>Uptime:</b> <span id="uptime">Loading...</span></p>
									<p><b>Web Server Status:</b> <span id="localhostPing"></span></p>
									<p><b>CBus Connection Status:</b> <span id="cbusStatus">Unknown</span></p><!-- Default to 'Unknown' or another placeholder -->
								</div>
								<div class="row multiple-row icon-v1">
									<div class="col-lg-4 col-md-6">
										<div class="col-wrap">
											<div class="ico-box">
												<div class="icon-title">
													<div class="icon">
														<span class="icon-dashboard-1"><span class="sr-only">&amp;</span></span>
													</div>
													<h4 class="content-title"><a href="#">CPU Usage:</a></h4>
												</div>
												<div class="icon-desc">
													<div class="des">
														<p><span id="cpuCores"></span>Cores at <span id="cpuUsage"></span>%</p>
														<canvas id="cpuLoadChart"></canvas>
													</div>
												</div>
											</div>
										</div>
									</div>
									<div class="col-lg-4 col-md-6">
										<div class="col-wrap">
											<div class="ico-box">
												<div class="icon-title">
													<div class="icon">
														<span class="icon-dashboard-1"><span class="sr-only">&amp;</span></span>
													</div>
													<h4 class="content-title"><a href="#">Ram Usage:</a></h4>
												</div>
												<div class="icon-desc">
													<div class="des">
														<p><span id="ramUsage"></span></p>
														<canvas id="ramUsageChart"></canvas>
													</div>
												</div>
											</div>
										</div>
									</div>
									<div class="col-lg-4 col-md-6">
										<div class="col-wrap">
											<div class="ico-box">
												<div class="icon-title">
													<div class="icon">
														<span class="icon-server"><span class="sr-only">&amp;</span></span>
													</div>
													<h4 class="content-title"><a href="#">Disk Space Usage:</a></h4>
												</div>
												<div class="icon-desc">
													<div class="des">
														<p><span id="diskUsage"></span></p>
														<canvas id="diskUsageChart"></canvas>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</section>
				</div><!--/main content wrapper -->
			</main>
		</div><!-- footer of the pagse -->
		<footer class="footer">
			<div class="footer-bottom text-center">
				<div class="container">
					<p>Made with &#10084; by Jayden Downes &VerticalLine; Version: 1.3</p>
				</div>
			</div>
		</footer><!--/footer of the page -->
	</div><!-- search form wrapper -->
	<div class="search-form-wrapper">
		<a class="nav-search-link close" href="#"><span class="icon-android-close"></span></a>
		<div class="holder">
			<input class="form-control form-control-v1" placeholder="Enter Your Search" type="search"> <button type="submit"><span class="custom-icon-search"></span></button>
		</div>
	</div><a class="section-scroll" href="#" id="scroll-to-top"><i class="fa fa-angle-up"></i></a> <!-- jquery library -->
	 
	<script src="/configuration-interface/vendors/jquery/jquery-2.1.4.min.js">
	</script> <!-- external scripts -->
	 
	<script src="/configuration-interface/vendors/tether/dist/js/tether.min.js">
	</script> 
	<script src="/configuration-interface/vendors/bootstrap/js/bootstrap.min.js">
	</script> 
	<script src="/configuration-interface/vendors/stellar/jquery.stellar.min.js">
	</script> 
	<script src="/configuration-interface/vendors/isotope/javascripts/isotope.pkgd.min.js">
	</script> 
	<script src="/configuration-interface/vendors/isotope/javascripts/packery-mode.pkgd.js">
	</script> 
	<script src="/configuration-interface/vendors/owl-carousel/dist/owl.carousel.js">
	</script> 
	<script src="/configuration-interface/vendors/waypoint/waypoints.min.js">
	</script> 
	<script src="/configuration-interface/vendors/counter-up/jquery.counterup.min.js">
	</script> 
	<script src="/configuration-interface/vendors/fancyBox/source/jquery.fancybox.pack.js">
	</script> 
	<script src="/configuration-interface/vendors/fancyBox/source/helpers/jquery.fancybox-thumbs.js">
	</script> 
	<script src="/configuration-interface/vendors/image-stretcher-master/image-stretcher.js">
	</script> 
	<script src="/configuration-interface/vendors/wow/wow.min.js">
	</script> 
	<script src="/configuration-interface/vendors/rateyo/jquery.rateyo.js">
	</script> 
	<script src="/configuration-interface/vendors/bootstrap-datepicker/js/bootstrap-datepicker.js">
	</script> 
	<script src="/configuration-interface/vendors/bootstrap-slider-master/src/js/bootstrap-slider.js">
	</script> 
	<script src="/configuration-interface/vendors/bootstrap-select/dist/js/bootstrap-select.min.js">
	</script> 
	<script src="/configuration-interface/js/mega-menu.js">
	</script> <!-- custom jquery script -->
	 
	<script src="/configuration-interface/js/jquery.main.js">
	</script> <!-- REVOLUTION JS FILES -->
	 
	<script src="/configuration-interface/vendors/rev-slider/revolution/js/jquery.themepunch.tools.min.js" type="text/javascript">
	</script> 
	<script src="/configuration-interface/vendors/rev-slider/revolution/js/jquery.themepunch.revolution.min.js" type="text/javascript">
	</script> <!-- SLIDER REVOLUTION 5.0 EXTENSIONS  (Load Extensions only on Local File Systems !  The following part can be removed on Server for On Demand Loading) -->
	 
	<script src="/configuration-interface/vendors/rev-slider/revolution/js/extensions/revolution.extension.actions.min.js" type="text/javascript">
	</script> 
	<script src="/configuration-interface/vendors/rev-slider/revolution/js/extensions/revolution.extension.carousel.min.js" type="text/javascript">
	</script> 
	<script src="/configuration-interface/vendors/rev-slider/revolution/js/extensions/revolution.extension.kenburn.min.js" type="text/javascript">
	</script> 
	<script src="/configuration-interface/vendors/rev-slider/revolution/js/extensions/revolution.extension.layeranimation.min.js" type="text/javascript">
	</script> 
	<script src="/configuration-interface/vendors/rev-slider/revolution/js/extensions/revolution.extension.migration.min.js" type="text/javascript">
	</script> 
	<script src="/configuration-interface/vendors/rev-slider/revolution/js/extensions/revolution.extension.navigation.min.js" type="text/javascript">
	</script> 
	<script src="/configuration-interface/vendors/rev-slider/revolution/js/extensions/revolution.extension.parallax.min.js" type="text/javascript">
	</script> 
	<script src="/configuration-interface/vendors/rev-slider/revolution/js/extensions/revolution.extension.slideanims.min.js" type="text/javascript">
	</script> 
	<script src="/configuration-interface/vendors/rev-slider/revolution/js/extensions/revolution.extension.video.min.js" type="text/javascript">
	</script> <!-- SNOW ADD ON -->
	 
	<script src="/configuration-interface/vendors/rev-slider/revolution-addons/snow/revolution.addon.snow.min.js" type="text/javascript">
	</script> <!-- revolutions slider script -->
	 
	<script src="/configuration-interface/js/revolution.js">
	</script> 
	<script>
	       // Define the initial timestamp when the page loads
	       const initialTimestamp = Date.now();
	       // Function to fetch system status data
	       function fetchSystemStatus() {
	       	return fetch('/status').then(response => {
	       		if (!response.ok) {
	       			throw new Error('Network response was not ok');
	       		}
	       		return response.json();
	       	}).catch(error => {
	       		console.error('Error fetching system status:', error);
	       		throw error; // Re-throw the error to be handled in the update function
	       	});
	       }
	       // Function to update system information
	       function updateSystemInfo(data) {
	       	document.getElementById('hostname').textContent = data.hostname;
	       	document.getElementById('systemModel').textContent = data.cpuInfo[0].model; // Assuming the model is the same for all CPUs
	       	document.getElementById('cpuUsage').textContent = data.cpuLoad.currentLoad.toFixed(2) + '%';
	       	document.getElementById('ramUsage').textContent = `Used: ${(data.ram.used / 1073741824).toFixed(2)} GB / Total: ${(data.ram.total / 1073741824).toFixed(2)} GB`;
	       	document.getElementById('diskUsage').textContent = `Used: ${(data.diskUsage[0].used / 1073741824).toFixed(2)} GB / Total: ${(data.diskUsage[0].size / 1073741824).toFixed(2)} GB`;
	       	// Update localhostPing status with a badge
	       	const localhostPingStatus = document.getElementById('localhostPing');
	       	localhostPingStatus.innerHTML = ''; // Clear previous content
	       	let badge = document.createElement('a');
	       	badge.href = '#';
	       	badge.classList.add('badge');
	       	if (data.localhostPing === 'Online') {
	       		badge.classList.add('badge-success');
	       		badge.textContent = 'Online';
	       	} else if (data.localhostPing === 'Loading') {
	       		badge.classList.add('badge-warning');
	       		badge.textContent = 'Loading..';
	       	} else {
	       		badge.classList.add('badge-danger');
	       		badge.textContent = 'Offline';
	       	}
	       	localhostPingStatus.appendChild(badge);
	       }
	       // Initialize the CPU Load Chart
	       const cpuLoadChart = new Chart(document.getElementById('cpuLoadChart').getContext('2d'), {
	       	type: 'line',
	       	data: {
	       		datasets: [{
	       			label: 'CPU Load',
	       			data: [],
	       			fill: false,
	       			borderColor: 'rgb(75, 192, 192)',
	       			tension: 0.1
	       		}]
	       	},
	       	options: {
	       		plugins: {
	       			legend: {
	       				display: false // This will hide the legend
	       			}
	       		},
	       		scales: {
	       			x: {
	       				type: 'realtime',
	       				realtime: {
	       					delay: 2000,
	       					refresh: 1000,
	       					onRefresh: chart => {
	       						fetchSystemStatus().then(data => {
	       							chart.data.datasets.forEach(dataset => {
	       								dataset.data.push({
	       									x: Date.now(),
	       									y: data.cpuLoad.currentLoad
	       								});
	       							});
	       						}).catch(error => {
	       							console.error('Failed to fetch new CPU load data:', error);
	       						});
	       					}
	       				}
	       			},
	       			y: {
	       				beginAtZero: true,
	       				max: 100 // Assuming the CPU load is in percentage
	       			}
	       		}
	       	}
	       });
	       // Initialize the RAM Usage Chart
	       const ramUsageChart = new Chart(document.getElementById('ramUsageChart').getContext('2d'), {
	       	type: 'line',
	       	data: {
	       		datasets: [{
	       			label: 'RAM Usage',
	       			data: [],
	       			fill: true,
	       			backgroundColor: 'rgba(0, 123, 255, 0.5)',
	       			borderColor: 'rgb(0, 123, 255)',
	       			tension: 0.1
	       		}]
	       	},
	       	options: {
	       		plugins: {
	       			legend: {
	       				display: false // This will hide the legend
	       			}
	       		},
	       		scales: {
	       			x: {
	       				type: 'realtime',
	       				realtime: {
	       					delay: 2000,
	       					refresh: 1000,
	       					onRefresh: chart => {
	       						fetchSystemStatus().then(data => {
	       							chart.data.datasets.forEach(dataset => {
	       								dataset.data.push({
	       									x: Date.now(),
	       									y: (data.ram.used / data.ram.total) * 100 // RAM usage as a percentage
	       								});
	       							});
	       						}).catch(error => {
	       							console.error('Failed to fetch new RAM usage data:', error);
	       						});
	       					}
	       				}
	       			},
	       			y: {
	       				beginAtZero: true,
	       				max: 100 // RAM usage is in percentage
	       			}
	       		}
	       	}
	       });
	       // Initialize the Disk Usage Chart
	       const diskUsageChart = new Chart(document.getElementById('diskUsageChart').getContext('2d'), {
	       	type: 'line',
	       	data: {
	       		datasets: [{
	       			label: 'Disk Usage',
	       			data: [],
	       			fill: true,
	       			backgroundColor: 'rgba(255, 99, 132, 0.5)',
	       			borderColor: 'rgb(255, 99, 132)',
	       			tension: 0.1
	       		}]
	       	},
	       	options: {
	       		plugins: {
	       			legend: {
	       				display: false // This will hide the legend
	       			}
	       		},
	       		scales: {
	       			x: {
	       				type: 'realtime',
	       				realtime: {
	       					delay: 2000,
	       					refresh: 1000,
	       					onRefresh: chart => {
	       						fetchSystemStatus().then(data => {
	       							chart.data.datasets.forEach(dataset => {
	       								// Assuming diskUsage is an array and you're interested in the first disk
	       								const disk = data.diskUsage[0];
	       								const usedPercentage = (disk.used / disk.size) * 100;
	       								dataset.data.push({
	       									x: Date.now(),
	       									y: usedPercentage
	       								});
	       							});
	       						}).catch(error => {
	       							console.error('Failed to fetch new Disk usage data:', error);
	       						});
	       					}
	       				}
	       			},
	       			y: {
	       				beginAtZero: true,
	       				max: 100 // Disk usage is in percentage
	       			}
	       		}
	       	}
	       });
	       // Update loop
	       function update() {
	       	fetchSystemStatus().then(data => {
	       		// Update system info
	       		updateSystemInfo(data);
	       	}).catch(error => {
	       		// Handle errors by logging and updating the UI with an error message
	       		console.error('Failed to update system status:', error);
	       		document.getElementById('hostname').textContent = 'Server Error';
	       		document.getElementById('systemModel').textContent = 'Error getting information';
	       		document.getElementById('cpuUsage').textContent = 'Error';
	       		document.getElementById('ramUsage').textContent = 'Error';
	       		document.getElementById('diskUsage').textContent = 'Error';
	       		document.getElementById('localhostPing').textContent = 'Error';
	       		document.getElementById('cbusStatus').textContent = 'Error';
	       		// Optionally, clear the chart data if needed
	       		cpuLoadChart.data.datasets.forEach(dataset => {
	       			dataset.data = []; // Clear CPU Load data
	       		});
	       		ramUsageChart.data.datasets.forEach(dataset => {
	       			dataset.data = []; // Clear RAM Usage data
	       		});
	       		// Update charts to reflect the cleared data
	       		cpuLoadChart.update();
	       		ramUsageChart.update();
	       	});
	       }
	       // Call update function every second
	       setInterval(update, 1000);
	</script>
</body>
</html>